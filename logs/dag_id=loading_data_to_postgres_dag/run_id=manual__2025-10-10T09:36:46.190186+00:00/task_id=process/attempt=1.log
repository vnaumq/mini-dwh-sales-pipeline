{"timestamp":"2025-10-10T09:36:47.705238","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-10-10T09:36:47.706165","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/loading_data_to_postgres_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-10-10T09:36:54.259424Z","level":"info","event":"✅ Загружено 452731 строк в таблицу season_ratio","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.260538Z","level":"info","event":"SUCCESS","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.618645Z","level":"info","event":"✅ Загружено 7000 строк в таблицу info_subjects","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.618849Z","level":"info","event":"SUCCESS","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.754609Z","level":"info","event":"✅ Загружено 12690 строк в таблицу info_subjects_days","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.754840Z","level":"info","event":"SUCCESS","chan":"stdout","logger":"task"}
{"timestamp":"2025-10-10T09:36:54.783990","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"InternalError","exc_value":"(psycopg2.errors.DependentObjectsStillExist) cannot drop table sales.category_l1_l2 because other objects depend on it\nDETAIL:  view category_statistics depends on table sales.category_l1_l2\nview sales.category_statistics depends on table sales.category_l1_l2\nHINT:  Use DROP ... CASCADE to drop the dependent objects too.\n\n[SQL: \nDROP TABLE sales.category_l1_l2]\n(Background on this error at: https://sqlalche.me/e/14/2j85)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":918,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1213,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":251,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/loading_data_to_postgres_dag.py","lineno":229,"name":"process"},{"filename":"/opt/airflow/dags/loading_data_to_postgres_dag.py","lineno":111,"name":"l1_l2"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3008,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":788,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1948,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1852,"name":"prep_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":929,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":2003,"name":"drop_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py","lineno":979,"name":"drop"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2221,"name":"_run_ddl_visitor"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py","lineno":524,"name":"traverse_single"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":1106,"name":"visit_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":80,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1477,"name":"_execute_ddl"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"DependentObjectsStillExist","exc_value":"cannot drop table sales.category_l1_l2 because other objects depend on it\nDETAIL:  view category_statistics depends on table sales.category_l1_l2\nview sales.category_statistics depends on table sales.category_l1_l2\nHINT:  Use DROP ... CASCADE to drop the dependent objects too.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
